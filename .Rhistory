debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
install.packages(c("data.table", "lubridate", "RPostgreSQL", "tidyverse"))
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
install.packages(c("data.table", "lubridate", "RPostgreSQL", "tidyverse"))
install.packages(c("data.table", "lubridate", "RPostgreSQL", "tidyverse"))
# friends table: joing no_fri_accept and adoptedFriends => showing number of friends and adopted friends
#AD_by_total = (no_fri_AD / no_friends)
friends <- no_fri_accept %>%
left_join(adopted_friends, by = "user_id") %>%
mutate(no_fri_AD = ifelse(is.na(no_fri_AD), 0, no_fri_AD)) %>%
mutate(AD_by_total = no_fri_AD / total_friends)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
View(friends)
nrow(homophily)
nrow(homophily)
nrow(tie_strength)
tie_strength
res
View(res)
View(homophily)
View(no_msg_friends)
View(recipes)
recipes[, ..i]
recipes[, ..1]
recipes[, ..2]
recipes[, ..2k]
recipes[, ..k]
cbind(1:5, 6:10, 11:15)
rbind(1:5, 6:10, 11:15)
matrix(x = 1:12, nrow = 3, ncol = 4)
matrix(x = 1:12, nrow = 3, ncol = 4)
matrix(x = 1:12, nrow = 3, ncol = 4)
data.frame("age" = c(19, 21),
sex = c("m", "f"))
x <- 1:5
matrix(x = 1:12, nrow = 3, ncol = 4)
matrix(data = 1:10,
nrow = 5,
ncol = 2)
matrix(data = 1:12, nrow = 3, ncol = 4)
matrix(data = 1:10,
nrow = 2,
ncol = 5,
byrow = TRUE)
matrix(data = 1:10,
nrow = 2,
ncol = 5,
byrow = FALSE)
xx <- ("sust", "vegetarian", "vegan")
xx <- c("sust", "vegetarian", "vegan")
yy <- paste0(xx, collapse="|")
yy
zz <- c("sust asdfsadf", "asdfvegetarian asdf", "vegana sdf", "12312", "erf23")
grep1(yy, zz, ignor.case=TRUE)
grepl(yy, zz, ignor.case=TRUE)
grepl(yy, zz, ignore.case=TRUE)
grepl("yy", zz, ignore.case=TRUE)
grepl("yvegetariany", zz, ignore.case=TRUE)
grepl("y vegetarian y", zz, ignore.case=TRUE)
grepl("y vegetarian y", zz, ignore.case=TRUE)
grepl("y vegetarian y  sust", zz, ignore.case=TRUE)
grepl(yy, "y vegetarian y  sust", ignore.case=TRUE)
grepl(yy, "yvegetariany  sust", ignore.case=TRUE)
grepl(yy, "yvegetariany  sussdfat", ignore.case=TRUE)
grepl(yy, "yvegetariany  sussdfat", ignore.case=TRUE)
grepl(paste0(words_sust, collapse = "|"),
recipes[, ..i], ignore.case = TRUE)
grepl(paste0(words_sust, collapse = "|"),
recipes[, ..1], ignore.case = TRUE)
is.na(t)
is.na(NULL)
is.na(NULLasdf)
is.na(a)
is.na()
is.na(t)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
t
grepl(paste0(words_sust, collapse = "|"),
recipes[, ..i], ignore.case = TRUE)
recipes[, ..i]
paste0(words_sust, collapse = "|")
grepl(paste0(words_sust, collapse = "|"),
recipes[, ..i], ignore.case = TRUE)
is.na(t)
t
is.na(FALSE)
is.na(TRUE)
is.na(t)
is.na(i)
t
t
t
sust
non_sust
ncol(recipes)
as.data.frame(sust)
rowSums(sust)
non_sust
non_sust
recipes$sustain
sust$sust
recipes_rate
View(recipes_rate)
as.Date(timestamp)
as.Date(recipes_rate$timestamp)
paste(user_id, time_yr, time_q)
paste(recipese$user_id, recipese$time_yr, recipese$time_q)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
View(unfriends)
View(friend_requests)
View(friend_accepts)
View(users)
fix(friend_accepts)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
View(friend_accepts)
fix(friend_accepts)
View(forum_threads)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
View(user_recipes_timepoints)
View(res)
View(recipes_timepoints)
View(recipes)
View(recipes_rate)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
tt01 <- friend_accepts %>%
rename(user_id = approver) %>%
left_join(users, by = "user_id") %>%
rename(birthday_approver = birthday,
cooking_skills_approver = cooking_skills) %>%
rename(approver = user_id,
user_id = requester) %>%
left_join(users, by = "user_id") %>%
mutate(
bd_diff_tmp = as.integer(difftime(birthday_approver, birthday, units = "days")),
bd_diff = ifelse(bd_diff_tmp == 0, 0, bd_diff_tmp / 365.25),
bd_same = ifelse(abs(bd_diff) < homophily_bd_criterion, 1, 0),
bd_points = ifelse(bd_same == 1, homophily_bd_similarity_point, 0),
cs_points = ifelse(cooking_skills_approver == cooking_skills, homophily_cooking_similarity_point, 0),
homophily = bd_points + cs_points) %>%
select(user_id_q, approver, homophily) %>%
merge(res[, c("user_id_q", "AD")], by = "user_id_q") %>% #here as well replaced recipe_rate with res table having AD
mutate(homophily = homophily * AD)
tt02<-friend_accepts %>%
rename(user_id = approver) %>%
left_join(users, by = "user_id") %>%
rename(birthday_approver = birthday,
cooking_skills_approver = cooking_skills) %>%
rename(approver = user_id,
user_id = requester) %>%
left_join(users, by = "user_id") %>%
mutate(
bd_diff_tmp = as.integer(difftime(birthday_approver, birthday, units = "days")),
bd_diff = ifelse(bd_diff_tmp == 0, 0, bd_diff_tmp / 365.25),
bd_same = ifelse(abs(bd_diff) < homophily_bd_criterion, 1, 0),
bd_points = ifelse(bd_same == 1, homophily_bd_similarity_point, 0),
cs_points = ifelse(cooking_skills_approver == cooking_skills, homophily_cooking_similarity_point, 0),
homophily = bd_points + cs_points) %>%
select(user_id_q, approver, homophily)
View(tt02)
tt03<-res[, c("user_id_q", "AD")]
View(tt03)
View(msg)
View(no_fri_accept)
View(no_msg_friends)
View(friend_accepts)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
View(friend_accepts)
as.POSIXct(1492854110, origin = "1970-01-01"))
as.POSIXct(1492854110, origin = "1970-01-01")
as.numeric(as.POSIXct("1997-09-15"))
fix(friend_accepts)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
tt01<-friend_accepts %>%
rename(user_id = approver) %>%
left_join(users, by = "user_id") %>%
rename(birthday_approver = birthday,
cooking_skills_approver = cooking_skills) %>%
rename(approver = user_id,
user_id = requester) %>%
left_join(users, by = "user_id") %>%
mutate(
bd_diff_tmp = as.integer(difftime(birthday_approver, birthday, units = "days")),
bd_diff = ifelse(bd_diff_tmp == 0, 0, bd_diff_tmp / 365.25),
bd_same = ifelse(abs(bd_diff) < homophily_bd_criterion, 1, 0),
bd_points = ifelse(bd_same == 1, homophily_bd_similarity_point, 0),
cs_points = ifelse(cooking_skills_approver == cooking_skills, homophily_cooking_similarity_point, 0),
homophily = bd_points + cs_points) %>%
select(user_id_q, approver, homophily) %>%
merge(res[, c("user_id_q", "AD")], by = "user_id_q") %>% #here as well replaced recipe_rate with res table having AD
mutate(homophily = homophily * AD)
tt02<-friend_accepts %>%
rename(user_id = approver) %>%
left_join(users, by = "user_id") %>%
rename(birthday_approver = birthday,
cooking_skills_approver = cooking_skills) %>%
rename(approver = user_id,
user_id = requester) %>%
left_join(users, by = "user_id") %>%
mutate(
bd_diff_tmp = as.integer(difftime(birthday_approver, birthday, units = "days")),
bd_diff = ifelse(bd_diff_tmp == 0, 0, bd_diff_tmp / 365.25),
bd_same = ifelse(abs(bd_diff) < homophily_bd_criterion, 1, 0),
bd_points = ifelse(bd_same == 1, homophily_bd_similarity_point, 0),
cs_points = ifelse(cooking_skills_approver == cooking_skills, homophily_cooking_similarity_point, 0),
homophily = bd_points + cs_points) %>%
select(user_id_q, approver, homophily)
View(tt02)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
View(friend_accepts)
fix(friend_accepts)
as.numeric(as.POSIXct("1997-09-15"))
fix(friend_accepts)
save.image("D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/1000Observation-11.RData")
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
tt01<-friend_accepts %>%
rename(user_id = approver) %>%
left_join(users, by = "user_id") %>%
rename(birthday_approver = birthday,
cooking_skills_approver = cooking_skills) %>%
rename(approver = user_id,
user_id = requester) %>%
left_join(users, by = "user_id") %>%
mutate(
bd_diff_tmp = as.integer(difftime(birthday_approver, birthday, units = "days")),
bd_diff = ifelse(bd_diff_tmp == 0, 0, bd_diff_tmp / 365.25),
bd_same = ifelse(abs(bd_diff) < homophily_bd_criterion, 1, 0),
bd_points = ifelse(bd_same == 1, homophily_bd_similarity_point, 0),
cs_points = ifelse(cooking_skills_approver == cooking_skills, homophily_cooking_similarity_point, 0),
homophily = bd_points + cs_points) %>%
select(user_id_q, approver, homophily)
View(tt01)
tt02<-friend_accepts %>%
rename(user_id = approver) %>%
left_join(users, by = "user_id") %>%
rename(birthday_approver = birthday,
cooking_skills_approver = cooking_skills) %>%
rename(approver = user_id,
user_id = requester) %>%
left_join(users, by = "user_id") %>%
mutate(
bd_diff_tmp = as.integer(difftime(birthday_approver, birthday, units = "days")),
bd_diff = ifelse(bd_diff_tmp == 0, 0, bd_diff_tmp / 365.25),
bd_same = ifelse(abs(bd_diff) < homophily_bd_criterion, 1, 0),
bd_points = ifelse(bd_same == 1, homophily_bd_similarity_point, 0),
cs_points = ifelse(cooking_skills_approver == cooking_skills, homophily_cooking_similarity_point, 0),
homophily = bd_points + cs_points) %>%
select(user_id_q, approver, homophily) %>%
merge(res[, c("user_id_q", "AD")], by = "user_id_q") %>% #here as well replaced recipe_rate with res table having AD
mutate(homophily = homophily * AD)
View(tt02)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
tt01<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id") %>%
left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id", "timepoints")) %>%
mutate(tie_strength = ifelse(is.na(tie_strength), 0, tie_strength)) %>%
mutate(homophily = ifelse(is.na(homophily), 0, homophily)) %>%
# keep the columns as indicated in the table
select(timestamp,
user_id,
timepoints.x,
recipe_id,
type,
sustain,
AD,
homophily,
tie_strength,
no_friends,
no_fri_AD,
AD_by_total)
tt01<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id") %>%
left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id", "timepoints")) %>%
mutate(tie_strength = ifelse(is.na(tie_strength), 0, tie_strength)) %>%
mutate(homophily = ifelse(is.na(homophily), 0, homophily)) %>%
# keep the columns as indicated in the table
select(timestamp,
user_id,
timepoints,
recipe_id,
type,
sustain,
AD,
homophily,
tie_strength,
no_friends,
no_fri_AD,
AD_by_total)
View(tt01)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
tt01<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id") %>%
left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id", "timepoints")) %>%
mutate(tie_strength = ifelse(is.na(tie_strength), 0, tie_strength)) %>%
mutate(homophily = ifelse(is.na(homophily), 0, homophily)) %>%
# keep the columns as indicated in the table
select(timestamp,
user_id,
timepoints,
recipe_id,
type,
sustain,
AD,
homophily,
tie_strength,
no_friends,
no_fri_AD,
AD_by_total) %>%
rename(recipe_type = type,
Adopted = AD,
Homophily = homophily,
Tie_Strength = tie_strength)
View(tt01)
View(tt01)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
tt01<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id") %>%
#left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id", "timepoints")) %>%
left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id")) %>%
mutate(tie_strength = ifelse(is.na(tie_strength), 0, tie_strength)) %>%
mutate(homophily = ifelse(is.na(homophily), 0, homophily)) %>%
# keep the columns as indicated in the table
select(timestamp,
user_id,
timepoints,
recipe_id,
type,
sustain,
AD,
homophily,
tie_strength,
no_friends,
no_fri_AD,
AD_by_total) %>%
rename(recipe_type = type,
Adopted = AD,
Homophily = homophily,
Tie_Strength = tie_strength)
tt02<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id")
View(tt02)
View(friends)
View(res)
View(res)
debugSource('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
tt01<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id") %>%
#left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id", "timepoints")) %>%
left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id")) %>%
mutate(tie_strength = ifelse(is.na(tie_strength), 0, tie_strength)) %>%
mutate(homophily = ifelse(is.na(homophily), 0, homophily)) %>%
mutate(no_friends = ifelse(is.na(no_friends), 0, no_friends)) %>%
mutate(no_fri_AD = ifelse(is.na(no_fri_AD), 0, no_fri_AD)) %>%
mutate(AD_by_total = ifelse(is.na(AD_by_total), 0, AD_by_total)) %>%
# keep the columns as indicated in the table
select(timestamp,
user_id,
timepoints,
recipe_id,
type,
sustain,
AD,
homophily,
tie_strength,
no_friends,
no_fri_AD,
AD_by_total)
tt01<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id") %>%
#left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id", "timepoints")) %>%
left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id")) %>%
mutate(tie_strength = ifelse(is.na(tie_strength), 0, tie_strength)) %>%
mutate(homophily = ifelse(is.na(homophily), 0, homophily)) %>%
mutate(no_friends = ifelse(is.na(no_friends), 0, no_friends)) %>%
mutate(no_fri_AD = ifelse(is.na(no_fri_AD), 0, no_fri_AD)) %>%
mutate(AD_by_total = ifelse(is.na(AD_by_total), 0, AD_by_total)) %>%
# keep the columns as indicated in the table
select(timestamp,
user_id,
timepoints,
recipe_id,
type,
sustain,
AD,
homophily,
tie_strength,
no_friends,
no_fri_AD,
AD_by_total) %>%
rename(recipe_type = type,
Adopted = AD,
Homophily = homophily,
Tie_Strength = tie_strength)
tt01<-res %>%
arrange(timestamp) %>%
left_join(homophily, by = "user_id") %>%
left_join(tie_strength, by = "user_id") %>%
left_join(friends, by = c("user_id" = "user_id", "recipe_id" = "recipe_id", "timepoints")) %>%
mutate(tie_strength = ifelse(is.na(tie_strength), 0, tie_strength)) %>%
mutate(homophily = ifelse(is.na(homophily), 0, homophily)) %>%
mutate(no_friends = ifelse(is.na(no_friends), 0, no_friends)) %>%
mutate(no_fri_AD = ifelse(is.na(no_fri_AD), 0, no_fri_AD)) %>%
mutate(AD_by_total = ifelse(is.na(AD_by_total), 0, AD_by_total)) %>%
# keep the columns as indicated in the table
select(timestamp,
user_id,
timepoints,
recipe_id,
type,
sustain,
AD,
homophily,
tie_strength,
no_friends,
no_fri_AD,
AD_by_total) %>%
rename(recipe_type = type,
Adopted = AD,
Homophily = homophily,
Tie_Strength = tie_strength)
View(tt01)
source('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
source('D:/Dev/Ilya/StefanB_ExistingRCode/Archive3/hazard_table_v2.R')
